(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+/sI":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n("ERkP"),a=n("TGcR"),s=n("t62R"),i=n("a6qo"),o=n("rHpw");const c="animated_gif",d="video";class u extends r.PureComponent{render(){const{durationInMilliseconds:e,type:t}=this.props;let n;if(t===c||"vine"===t)n=t===c?r.createElement(s.c,{weight:"bold"},"GIF"):r.createElement(a.a,{style:l.icon});else if(t===d&&e){const t=Math.trunc(e/6e4),a=`0${Math.trunc(e%6e4/1e3)}`.slice(-2);n=r.createElement(s.c,{color:"white"},`${t}:${a}`)}return n?r.createElement(i.a,{align:"left"},n):null}}const l=o.a.create((e=>({icon:{color:e.colors.white}})));t.c=u},"/Imo":function(e,t,n){"use strict";var r=n("97Jx"),a=n.n(r),s=n("KEM+"),i=n.n(s),o=(n("kYxP"),n("ERkP")),c=n("/yvb"),d=n("k/Ka"),u=n("3XMw"),l=n.n(u),p=n("rHpw");const _=l.a.i5450beb,m=l.a.f7432494;class E extends o.Component{constructor(...e){super(...e),i()(this,"_handlePress",(e=>{const{onPress:t}=this.props;t&&t(e),this._fileInput&&this._fileInput.click()})),i()(this,"_handleChange",(e=>{const{onChange:t}=this.props,n=e.target,r=n.files;r.length&&t&&t(r),n.value=""})),i()(this,"_handleFileInputButtonRef",(e=>{this._fileInput=e}))}render(){const{accept:e,disabled:t,multiple:n,onChange:r,testID:s,...i}=this.props,u=!(null!=e&&e.includes("video")||null!=e&&e.includes("gif"));return o.createElement(o.Fragment,null,o.createElement(c.a,a()({},i,{disabled:t,hoverLabel:e?{label:u?m:_}:void 0,onPress:this._handlePress})),Object(d.a)("input",{accept:e,disabled:t,multiple:n,onChange:this._handleChange,ref:this._handleFileInputButtonRef,style:f.input,tabIndex:-1,testID:s,type:"file"}))}}i()(E,"defaultProps",{disabled:!1,multiple:!1});const f=p.a.create((e=>({input:{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1}})));t.a=E},"07FG":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("cnVF");const a=e=>e===r.v},"4q8G":function(e,t,n){"use strict";var r=n("t0aI");t.a=({sort_event_id:e},{sort_event_id:t})=>e?t?Object(r.a)(t,e):1:-1},"7myi":function(e,t,n){"use strict";var r=n("KEM+"),a=n.n(r),s=(n("kYxP"),n("ERkP")),i=n("oEoC"),o=n("2dXj"),c=n("GZwR");class d extends s.Component{constructor(...e){super(...e),a()(this,"_genericWrapperRef",s.createRef()),a()(this,"state",{queryContext:void 0,canShowTypeahead:!1}),a()(this,"render",(()=>{const{contextText:e,children:t,isInline:n,onTypeaheadStateChange:r,source:a}=this.props,{queryContext:i,canShowTypeahead:d}=this.state,u=d&&i?{word:i.word,resultType:i.resultType}:void 0;return s.createElement(o.a,{contextText:e,isInline:n,onDismiss:this._handleDismiss,onSelectItem:this._handleSelectItem,onTypeaheadStateChange:r,query:u,ref:this._genericWrapperRef,source:a||c.d.Compose},t(this._handleInputChange))})),a()(this,"_handleSelectItem",(e=>{const{onTextUpdated:t}=this.props,{queryContext:n}=this.state;if(n){const r="users"===n.resultType&&"user"===e.type?`@${e.data.screen_name} `:`${e.data.topic||e.data.text||""} `,{newCursor:a,newTweetText:s}=this._replaceToken(r,n);t({target:{value:s}}),this._updateDOMTextArea(a,s)}this._setQueryContext(void 0)})),a()(this,"_updateDOMTextArea",((e,t)=>{this._textAreaRef&&(this._textAreaRef.value=t,this._textAreaRef.selectionStart=e,this._textAreaRef.selectionEnd=e,this._textAreaRef.focus())})),a()(this,"_handleInputChange",(e=>{const t=e&&(e.currentTarget||e.target),{queryContext:n}=this.state;this._textAreaRef=t;const r=n&&n.word,a=t.value,{word:s,start:o,end:c}=i.c(t.selectionStart,a),d=i.d(s||"","compose");if((null==d?void 0:d.q)!==r)if(this._genericWrapperRef.current&&this._genericWrapperRef.current.resetSelectedItem(),-1===o)this._setQueryContext(void 0);else if(d){const{q:e,result_type:n}=d;this._setQueryContext({word:e,resultType:n,fullText:t.value,startIndex:o,endIndex:c})}else this._setQueryContext(void 0)})),a()(this,"_setQueryContext",(e=>this.setState({queryContext:e,canShowTypeahead:!!e}))),a()(this,"_handleDismiss",(()=>this.setState({canShowTypeahead:!1})))}_replaceToken(e,t){const{fullText:n,startIndex:r,endIndex:a}=t,s=n.slice(0,r);return{newTweetText:s+e+n.slice(a),newCursor:s.length+e.length}}}t.a=d},AQ79:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));const r="directMessages",a=`rweb/${r}`,s=e=>`${a}/${e}`},BqYg:function(e,t){function n(e,t,n){var r,a,s,i,o;function c(){var d=Date.now()-i;d<t&&d>=0?r=setTimeout(c,t-d):(r=null,n||(o=e.apply(s,a),s=a=null))}null==t&&(t=100);var d=function(){s=this,a=arguments,i=Date.now();var d=n&&!r;return r||(r=setTimeout(c,t)),d&&(o=e.apply(s,a),s=a=null),o};return d.clear=function(){r&&(clearTimeout(r),r=null)},d.flush=function(){r&&(o=e.apply(s,a),s=a=null,clearTimeout(r),r=null)},d}n.debounce=n,e.exports=n},KqB4:function(e,t,n){"use strict";var r=n("IGGJ");Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=[],r=(0,a.default)(e,t),s=0;s<r.length;s++)n.push(r[s].url);return n};var a=r(n("vwfs"));e.exports=t.default},LCtV:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("KEM+"),a=n.n(r),s=(n("kYxP"),n("ERkP")),i=n("3XMw"),o=n.n(i),c=n("mN6z"),d=n("Qwev"),u=n("rHpw"),l=n("1auM"),p=n("ude7"),_=n("U+bB"),m=n("MWbm");const E=o.a.gff1f69e,f=Object.freeze({INFINITE:"infinite",MEDIUM:"medium",NONE:"none"});class I extends s.Component{constructor(...e){super(...e),a()(this,"state",{imagePreviewUrl:null}),a()(this,"_getImageSrc",(()=>{const{mediaItem:e,enableGif:t}=this.props,{imagePreviewUrl:n}=this.state;if(e&&e.mediaFile)return e.mediaFile.isGif&&!t?n:e.mediaFile.url}))}componentDidUpdate(){const{enableGif:e,mediaItem:{mediaFile:t}}=this.props,{imagePreviewUrl:n}=this.state;e||n||t instanceof l.a&&t.isGif&&Object(p.a)(t).then((e=>{this.setState({imagePreviewUrl:e})}))}shouldComponentUpdate(e,t){return!Object(c.a)(e,this.props)||!Object(c.a)(t,this.state)}render(){const{borderRadius:e,enableGif:t,mediaItem:n,onClick:r}=this.props,{imagePreviewUrl:a}=this.state||{},i=n.mediaFile&&n.mediaFile.isGif&&!t&&!a,o=n.needsProcessing||i,c=[b.root,h[e],o&&b.loadingBorder],u=this._getImageSrc();return s.createElement(m.a,{onClick:r,style:c},o||!u?s.createElement(d.a,{accessibilityLabel:E,style:b.activityIndicator}):s.createElement(_.a,{resizeMode:"cover",source:u,style:b.image}))}}a()(I,"defaultProps",{borderRadius:f.NONE,enableGif:!0});const h=u.a.create((e=>({[f.INFINITE]:{borderRadius:e.borderRadii.infinite},[f.MEDIUM]:{borderRadius:e.borderRadii.small},[f.NONE]:{borderRadius:e.borderRadii.none}}))),b=u.a.create((e=>({root:{borderRadius:e.borderRadii.xLarge,borderStyle:"solid",borderWidth:e.borderWidths.none,borderColor:"transparent",maxWidth:"100%",height:"100%",overflow:"hidden"},image:{display:"block",height:"100%",width:"100%"},loadingBorder:{borderColor:e.colors.gray300},activityIndicator:{height:"100%"}})));t.b=I},MLl7:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));const r=Object.freeze({Composition:"composition",DMComposition:"dm_composition"}),a=e=>Object.values(r).indexOf(e)>=0,s=(e,t)=>"boolean"==typeof e?e:t},VPdC:function(e,t,n){"use strict";n.d(t,"b",(function(){return h}));var r=n("97Jx"),a=n.n(r),s=n("KEM+"),i=n.n(s),o=n("ERkP"),c=n("3XMw"),d=n.n(c),u=n("cjZk"),l="fileInput",p=n("sjK1"),_=n("/Imo"),m=n("rHpw"),E=n("9HgX");const f=d.a.b9960f31,I=o.createElement(u.a,null),h=({acceptGifs:e,acceptImages:t=!0,acceptVideo:n})=>(t?E.b:[]).concat(e?[E.a]:[]).concat(n?p.a:[]);class b extends o.PureComponent{render(){const{acceptGifs:e,acceptImages:t,acceptVideo:n,customMimeTypes:r,icon:s,style:i,withIcon:c,...d}=this.props,u=h({acceptGifs:e,acceptImages:t,acceptVideo:n}).concat(r).join(",");return o.createElement(_.a,a()({},d,{accept:u,icon:c?s:void 0,style:[y.root,i],testID:l}))}}i()(b,"defaultProps",{acceptGifs:!0,acceptImages:!0,acceptVideo:!0,customMimeTypes:[],accessibilityLabel:f,icon:I,size:"normal",withIcon:!0});const y=m.a.create((e=>({root:{margin:`-${e.spaces.space12}`}})));t.a=b},VY6S:function(e,t,n){"use strict";var r=n("BqYg"),a=n.n(r);t.a=(e,t,n)=>a()(e,t,n)},VnFT:function(e,t,n){"use strict";n.d(t,"m",(function(){return O})),n.d(t,"l",(function(){return A})),n.d(t,"f",(function(){return T})),n.d(t,"d",(function(){return R})),n.d(t,"g",(function(){return N})),n.d(t,"e",(function(){return D})),n.d(t,"i",(function(){return x})),n.d(t,"j",(function(){return P})),n.d(t,"k",(function(){return j})),n.d(t,"h",(function(){return U})),n.d(t,"a",(function(){return V})),n.d(t,"b",(function(){return B})),n.d(t,"c",(function(){return q}));n("kYxP");var r=n("AspN"),a=n("xPna"),s=n("oEOe"),i=n("xCUF"),o=n("ude7"),c=n("07FG"),d=n("Ssj5"),u=n("fEA7"),l=n.n(u),p=n("uKEd"),_=n("lnti"),m=n("/NU0");const E="multiDraftDMs",f=e=>`rweb/multiDraftDMs/${e}`,I={};const h=e=>{const{conversation_id:t,id:n,localMediaId:r,recipient_ids:a,sender_id:s,text:i,attachment:o={},error:c}=e,d=Date.now().toString();return{conversation_id:t,recipient_ids:a,error:c,id:n,is_draft:!0,message_data:{attachment:o,localMediaId:r,sender_id:s,text:i,time:d},type:"message",time:d}},b=f("SEND_MESSAGE_REQUEST"),y=f("SEND_MESSAGE_SUCCESS"),v=f("SEND_MESSAGE_FAILURE"),O=e=>(t,n,{api:d})=>{const{senderId:u,cardUrl:E,conversationId:f,localMediaId:I,recipients:O=[],requestId:g=l.a.v1(),tweetAttachment:A,quickReply:S,...T}=e||{};t(K(f));const C=n(),N=I||w(n(),f),[M]=r.h(C,N),{mediaFile:D,mediaMetadata:x}=M||{},P=O.length>0&&O.join(","),j={};D&&D.isGif?j.extraInitParams="&media_category=dm_gif":D&&D.isVideo&&(j.extraInitParams="&media_category=dm_video");const L=r.m(N,j),V=[t(L)],k=U(C,f),{found_media_origin:B}=k||{};return D&&D.isGif&&V.push(Object(o.a)(D)),Promise.all(V).then((([[n],o])=>{const l=(null==x?void 0:x.altText)||(null==x?void 0:x.defaultAltText),I=!!l;return(n&&(B||I)?t(r.j({media_id:n.uploadId,found_media_origin:B,...!!I&&{alt_text:{text:l}}})):Promise.resolve()).then((()=>{const{id_str:r}=A||{},l={};if(n){const{mediaFile:e={}}=n,t={original_info:{width:e.width,height:e.height},sizes:[{h:e.height,w:e.width,resize:"fit"}]};e.isImage?l.photo={...t,media_url_https:e.url}:e.isGif?l.animated_gif={...t,media_url_https:o,type:"animated_gif"}:e.isVideo&&(l.video={...t,media_url_https:e.url,type:"video"})}else A&&(l.tweet={status:r});const{uploadId:I}=n||{},O=h({attachment:l,conversation_id:f,id:g,recipient_ids:P,sender_id:u,text:e.text}),C={...T,...Object(c.a)(E)&&{card_uri:E},conversation_id:f,...!r&&{media_id:I},recipient_ids:P,request_id:g,tweet_id:r};S&&(C["quick_reply_response[options][id]"]=S.id,C["quick_reply_response[options][selected_id]"]=S.selected_id);const M=Object(_.a)([z(f),{type:i.c.REQUEST},{type:b},f&&Object(p.b)(f,g,O)]);return t(M),d.DirectMessages.sendMessage(C).then((n=>{const{entries:r,users:s,tweets:o,cards:c,fleets:d}=n.entities,{conversations:u}=n.result;Object(m.a)(N)&&t(q(f,N));const l=Object(_.a)([{type:i.c.SUCCESS},...Object(a.c)({conversations:u,entries:r,users:s,tweets:o,cards:c,fleets:d}),{type:y},f&&Object(p.j)(f,g,e),R(f)]);return t(l),Promise.resolve(Object.values(n.entities.entries)[0].conversation_id)}),(n=>{const r=h({attachment:l,conversation_id:f,error:!0,id:g,localMediaId:N,recipient_ids:P,sender_id:u,text:e.text}),a=Object(_.a)([{type:i.c.SUCCESS},{type:v},f&&Object(p.b)(f,g,r)]);return t(a),Object(s.e)(t,n,"ACTION_SEND_DM")}))}),(e=>(t(Y(f)),e.type="metadata",Promise.reject(e))))}),(e=>(t(Object(_.a)([Object(m.a)(N)&&q(f,N),Y(f)])),Promise.reject(e))))},g=(e,t)=>e.multiDraftDMs[t],A=(e,t)=>{const n=g(e,t);return n?n.text:null},S=f("SAVE_TEXT"),T=(e,t)=>({type:S,conversationId:e,text:t}),C=f("REMOVE_TEXT"),R=e=>({type:C,conversationId:e}),N=(e,t)=>{const n=g(e,t);return n?n.cardUrl:null},M=f("SAVE_CARD_URL"),D=(e,t)=>({type:M,conversationId:e,cardUrl:t}),w=(e,t)=>{const n=g(e,t);return n?n.mediaId:null},x=(e,t)=>{const n=r.h(e,w(e,t));return n.length>0?n[0]:null},P=(e,t)=>{const n=g(e,t);return!!n&&n.isUploading},j=(e,t)=>r.i(e,w(e,t)),U=(e,t)=>{const n=g(e,t);return n?n.gifMetadata:null},L=f("ADD_MEDIA"),V=(e,[t],n)=>({payload:{isUploading:!1,mediaId:t,gifMetadata:n},type:L,conversationId:e}),k=f("CANCEL_UPLOAD"),B=e=>({type:k,conversationId:e}),F=f("REMOVE_MEDIA"),G=e=>({type:F,conversationId:e}),q=(e,t)=>n=>{n(r.f(t)),n([B(e),G(e)])},H=f("UPLOAD_REQUEST"),K=e=>({type:H,conversationId:e}),W=f("UPLOAD_SUCCESS"),z=e=>({type:W,conversationId:e}),Q=f("UPLOAD_FAILURE"),Y=e=>({type:Q,conversationId:e});d.a.register({[E]:function(e=I,t){const n=t.conversationId||"new_group";switch(t.type){case L:{const r=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaId:null,text:null};return{...e,[n]:{...r,...t.payload}}}case H:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaId:null,text:null};return{...e,[n]:{...t,isUploading:!0}}}case k:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaId:null,text:null};return{...e,[n]:{...t,isUploading:!1}}}case Q:case W:case F:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaId:null,text:null};return{...e,[n]:{...t,isUploading:!1,mediaId:null,gifMetadata:void 0}}}case S:{const r=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaId:null,text:null};return{...e,[n]:{...r,text:t.text}}}case M:{const r=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaId:null,text:null};return{...e,[n]:{...r,cardUrl:t.cardUrl}}}case C:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaId:null,text:null};return{...e,[n]:{...t,text:null}}}default:return e}}})},WVrH:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("AQ79");const a=Object(r.c)("RESET"),s=()=>({type:a})},aWyx:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return i}));const r=Object.freeze({ONE_TO_ONE:"ONE_TO_ONE",GROUP:"GROUP_DM"}),a=Object.freeze({AT_END:"AT_END",HAS_MORE:"HAS_MORE"}),s=Object.freeze({CONVERSATION_AVATAR_UPDATE:"conversation_avatar_update",CONVERSATION_NAME_UPDATE:"conversation_name_update",CONVERSATION_PROFILE_INFO_HEADER:"conversation_profile_info_header",CONVERSATION_READ:"conversation_read",CONVO_METADATA_UPDATE:"convo_metadata_update",DISABLE_NOTIFICATIONS:"disable_notifications",ENABLE_NOTIFICATIONS:"enable_notifications",JOIN_CONVERSATION:"join_conversation",MARK_ALL_AS_READ:"mark_all_as_read",MENTION_NOTIFICATIONS_UPDATE:"mention_notifications_setting_update",MESSAGE:"message",MESSAGE_DELETE:"message_delete",MESSAGE_MARK_AS_NOT_SPAM:"message_unmark_as_spam",MESSAGE_MARK_AS_SPAM:"message_mark_as_spam",PARTICIPANTS_JOIN:"participants_join",PARTICIPANTS_LEAVE:"participants_leave",REACTION_CREATE:"reaction_create",REACTION_DELETE:"reaction_delete",READ_ONLY_INDICATOR:"read_only_indicator",REMOVE_CONVERSATION:"remove_conversation",TRUST_CONVERSATION:"trust_conversation",TYPING_INDICATOR:"typing_indicator",WELCOME_MESSAGE:"welcome_message_create"}),i=Object.freeze({MUTUAL_FRIENDS:"mutual_friends"})},b5s6:function(e,t,n){"use strict";var r=n("97Jx"),a=n.n(r),s=n("ERkP"),i=n("v6aA"),o=n("rxPX"),c=n("0KEI"),d=n("XOJV"),u=n("eSoz");const l=(e,t)=>t.tweetId,p=(e,t)=>{const n=t.tweetId,r=n&&d.a.select(e,n);return r?Object(u.c)(e,r):void 0};var _=Object(o.a)().propsFromState((()=>({community:p,hydratedTweet:d.a.createHydratedTweetSelector(l)}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(c.d)("QUOTE_TWEET_CONTAINER"),fetchCommunityIfNeeded:u.a.fetchOneIfNeeded}))),m=n("YeIG"),E=n("uCxL"),f=n("x5Pi");const I=_((({hydratedTweet:e,tweetId:t,community:n,fetchCommunityIfNeeded:r,createLocalApiErrorHandler:o,...c})=>{const{featureSwitches:d,loggedInUserId:u}=s.useContext(i.a),l=null==e?void 0:e.community_id_str;s.useEffect((()=>{l&&Object(m.a)(n)&&r(l).catch(o())}),[n,l,o,r]);const p=d.isTrue("responsive_web_alt_text_badge_enabled"),_=e&&Object(f.d)(e,u,n),I=_&&Object(f.c)(_);return s.createElement(E.a,a()({},c,{loggedInUserId:u,shouldShowAltLabelAlways:p,socialContextProps:I,tweet:e}))}));t.a=I},cIoY:function(e,t,n){"use strict";var r=n("ERkP"),a=n("1YZw"),s=n("rxPX"),i=Object(s.a)().propsFromActions((()=>({addToast:a.b}))),o=n("KEM+"),c=n.n(o),d=(n("kYxP"),n("k/Ka")),u=n("3XMw"),l=n.n(u),p=n("sgih"),_=n("t62R"),m=n("/yvb"),E=n("rHpw");const f=l.a.cfd2f35d;class I extends r.Component{constructor(...e){super(...e),c()(this,"_handleOnFocus",(e=>{e.currentTarget.select()}))}render(){const{cancelButtonLabel:e,description:t,headerText:n,link:a,onCancel:s}=this.props,i=Object(d.a)("input",{autoFocus:!0,onFocus:this._handleOnFocus,readOnly:!0,style:h.linkInput,value:a});return r.createElement(p.a,{onMaskClick:s,style:h.container,type:"center",withMask:!0},n&&r.createElement(_.c,{align:"center",color:"normal",style:h.headerText,weight:"bold"},n),t&&r.createElement(_.c,{align:"center",color:"gray600",style:h.labelText},t),i,r.createElement(m.a,{onPress:s,size:"normalLarge",style:h.cancelButton,type:"text"},e))}}c()(I,"defaultProps",{cancelButtonLabel:f});const h=E.a.create((e=>({container:{alignItems:"center",paddingVertical:e.spaces.space32,paddingHorizontal:e.spaces.space12,position:"relative"},headerText:{marginBottom:e.spaces.space16},labelText:{marginBottom:e.spaces.space16,width:"100%"},linkInput:{backgroundColor:e.colors.gray0,borderColor:"transparent",color:e.colors.gray600,fontSize:e.fontSizes.normal,marginBottom:e.spaces.space12,paddingVertical:e.spaces.space12,paddingHorizontal:e.spaces.space20},cancelButton:{width:"100%"}})));var b=I,y=n("I/9y"),v=n("mjJ+"),O=n("cm6r"),g=n("CaKu"),A=n("U+bB");const S=l.a.e05c00b4,T=l.a.eabf2209,C=l.a.a613e72f,R=l.a.f88553c8,N={riffsy:"https://abs.twimg.com/a/1501527574/img/t1/icon_riffsy.png",giphy:"https://abs.twimg.com/a/1501527574/img/t1/icon_giphy.png"};class M extends r.PureComponent{constructor(e){super(e),c()(this,"_renderMenu",(e=>r.createElement(v.a,{items:[{text:C,Icon:y.a,onClick:this._handleCopyGifLinkButtonClick}],onCloseRequested:e}))),c()(this,"_handleCopyGifLinkButtonClick",(e=>{const{addToast:t,gifUrl:n}=this.props;g.a.isAvailable()?(g.a.setString(n),t({text:R})):this.setState({showCopyLinkSheet:!0}),e&&e()})),c()(this,"_handleCopyLinkSheetCancel",(()=>{this.setState({showCopyLinkSheet:!1})})),this.state={showCopyLinkSheet:!1}}render(){const{showCopyLinkSheet:e}=this.state,{provider:t,gifUrl:n}=this.props,{display_name:a,name:s}=t,i=N[s];return i?r.createElement(r.Fragment,null,e?r.createElement(b,{description:T({providerName:a}),headerText:S,link:n,onCancel:this._handleCopyLinkSheetCancel}):null,r.createElement(_.c,{align:"center",color:"gray600",style:D.root},r.createElement(l.a.I18NFormatMessage,{$i18n:"e2e6ea0d"},this._renderAttribution(a,i)))):null}_renderAttribution(e,t){return r.createElement(O.a,{interactiveStyles:null,renderMenu:this._renderMenu},r.createElement(_.c,{weight:"bold",withInteractiveStyling:!0},r.createElement(A.a,{source:{uri:t},style:D.image}),r.createElement(_.c,{color:"normal"},e.toUpperCase())))}}const D=E.a.create((e=>({button:{marginLeft:e.spaces.space12},image:{display:"inline-block",height:e.spaces.space16,marginHorizontal:e.spaces.space4,width:e.spaces.space16},root:{marginHorizontal:e.spaces.space12}})));var w=M;const x=i((({addToast:e,provider:t,gifUrl:n})=>r.createElement(w,{addToast:e,gifUrl:n,provider:t})));t.a=x},gpVt:function(e,t,n){"use strict";n.d(t,"b",(function(){return R}));var r=n("KEM+"),a=n.n(r),s=n("ERkP"),i=(n("kYxP"),n("ge3j")),o=n("VnFT"),c=n("vjRr"),d=n("rxPX"),u=n("0KEI");const l=(e,t)=>{const{urls:n}=t,r=[...n];let a;for(const t of r.reverse())if(a=c.a.select(e,t),a)break;return a};var p=Object(d.a)().propsFromState((()=>({card:l}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(u.d)("COMPOSER_CARD_PREVIEW"),fetchCardPreviewIfNeeded:c.a.fetchCardPreviewIfNeeded,updateDMComposer:o.e,updateTweetComposer:i.y}))),_=n("KqB4"),m=n.n(_),E=n("aX4+"),f=n("3XMw"),I=n.n(f),h=n("hOZg"),b=n("cnVF"),y=n("MWbm"),v=n("v6aA"),O=n("/yvb"),g=n("rHpw"),A=n("VY6S"),S=n("mN6z");const T=I.a.f6fec9f6,C=/^https?:\/\//i,R=e=>{const t=m()(e);if(t.length)return t.map((e=>!C.test(e)&&`http://${e}`||e))};class N extends s.Component{constructor(e,t){super(e,t),a()(this,"_fetchCardPreviewIfNeeded",(()=>{const{fetchCardPreviewIfNeeded:e,urls:t,createLocalApiErrorHandler:n}=this.props;t.forEach((t=>{e(t).catch(n())}))})),a()(this,"_handleCardPreviewDismissal",(e=>this._updateSingleComposer({cardUrl:b.v}))),a()(this,"_updateSingleComposer",(e=>{const{conversationId:t,index:n,updateDMComposer:r,updateTweetComposer:a}=this.props,{cardUrl:s}=e||{};this._isDMComposer?t&&r(t,s):a({updates:{cardUrl:s},index:n})})),this._debouncedFetchCardPreview=Object(A.a)(this._fetchCardPreviewIfNeeded,1e3),this._isDMComposer=!!e.conversationId}componentDidMount(){this._debouncedFetchCardPreview()}componentDidUpdate(e){const{urls:t}=this.props;Object(S.a)(e.urls,t)||this._debouncedFetchCardPreview()}componentWillUnmount(){this._updateSingleComposer()}render(){const{card:e,isCardPreviewTombstoned:t,style:n}=this.props,{loggedInUserId:r}=this.context;return e&&!t&&r?s.createElement(y.a,{style:n},s.createElement(E.a,{card:{name:e.name,url:e.url,binding_values:e.binding_values},cardContext:{tweetUserId:r},isInteractive:!1,preventVideoPlayback:!0}),s.createElement(O.a,{accessibilityLabel:T,icon:s.createElement(h.a,null),onPress:this._handleCardPreviewDismissal,size:"small",style:M.closeButton,type:"onMedia"})):null}}a()(N,"contextType",v.a);const M=g.a.create((e=>({closeButton:{position:"absolute",top:e.spaces.space4,left:e.spaces.space4}}))),D=p(N);t.a=D},jtO7:function(e,t,n){"use strict";var r=n("97Jx"),a=n.n(r),s=n("ERkP"),i=n("t62R"),o=n("I4+6"),c=n("cm6r"),d=n("rHpw"),u=n("MWbm");const l=d.a.create((e=>({container:{backgroundColor:e.colors.cellBackground},root:{justifyContent:"center",minHeight:e.spaces.space48,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16},bottomBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:1}})));t.a=({align:e="center",color:t,label:n,withBottomBorder:r=!0,...p})=>{const _=o.a.generate({backgroundColor:d.a.theme.colors.transparent,color:d.a.theme.colors[t],insetFocusRing:!0}),m=[l.root,r&&l.bottomBorder];return s.createElement(u.a,{style:l.container},s.createElement(c.a,a()({},p,{interactiveStyles:_,style:m}),s.createElement(i.c,{align:e,color:t},n)))}},kIAd:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n("0vv5");const a=500,s={scoper:[{type:"dmUserSearch",regexp:/^[@＠]?(.*)|^$/,srcInputs:["compose_message"],scope:{result_type:"users",count:20}},{type:"username",regexp:/^[@＠](\w{1,20})/,srcInputs:["compose"],scope:{result_type:"users",count:20}},{type:"hashtag",regexp:n.n(r).a,srcInputs:["compose"],scope:{result_type:"topics",count:20}},{type:"topic",regexp:/(.+)/,srcInputs:["search_box"],scope:{result_type:"all"}},{type:"ttt",regexp:/(.+)/,srcInputs:["welcome_flow"],scope:{count:10,result_type:"topics,ttt"}}],WordBoundary:/[!'%&'()*+,\\\-./:;<=>?[\]^{|}~\s]|$/,WordEnd:/[^!'%&'()*+,\\\-./:;<=>?[\]^{|}~\s]+$/}},krmn:function(e,t,n){"use strict";n("kYxP");var r=n("ERkP"),a=n("zb92"),s=n("RuTB"),i=n("3XMw"),o=n.n(i),c=Object(a.a)({loader:()=>o.a.emoji.then((()=>Promise.all([n.e(17),n.e(12),n.e(171)]).then(n.bind(null,"5RdJ")))),renderPlaceholder:(e,t)=>r.createElement(s.a,{hasError:e,onRetry:t})}),d=n.p+"twemoji_sprite.4b2aa715.png",u=n.p+"twemoji_sprite_high_res.c9967b15.png",l=n("rHpw"),p=n("U+bB"),_=n("kLqS"),m=n("MWbm");const E=l.a.create((e=>({content:{backgroundColor:e.colors.cellBackground},dimensions:{height:"400px",borderRadius:e.borderRadii.xLarge,minWidth:`calc(${e.spaces.space32} * 9 + 2 * ${e.spaces.space12})`},hidden:{display:"none"}})));var f=e=>{const{partialRender:t,onSelect:n}=e,a=_.a.get()>1?u:d;return r.createElement(r.Fragment,null,r.createElement(m.a,{style:[E.content,E.dimensions]},r.createElement(c,{onSelect:n,partialRender:t,rowSize:9,spriteUrl:a})),r.createElement(p.a,{source:a,style:E.hidden}))},I=n("pNJr"),h=n("2ZFc"),b=n("OiMc"),y=n("/yvb");const v=o.a.d4a4842d,O=r.createElement(I.a,null),g=o.a.fec16c1c,A=e=>{const{disabled:t,onEmojiSelect:n,onPress:a,size:s,style:i,textInputRef:o}=e,[d,u]=r.useState(!0);r.useEffect((()=>{setTimeout((()=>{c.preload(),h.a.get("emojiPicker2")}),5e3)}),[]);return r.createElement(b.a,{enableEnterKeyToggle:!0,onAnimateComplete:()=>u(!1),onDismiss:()=>u(!0),onHoverCardUnmount:()=>{window.requestAnimationFrame((()=>o&&o.focus()))},renderContent:()=>r.createElement(f,{onSelect:n,partialRender:d}),withArrow:!0},r.createElement(y.a,{accessibilityHasPopup:"menu",accessibilityLabel:v,disabled:t,hoverLabel:{label:g},icon:O,onPress:e=>a&&a(e),size:s,style:i,type:"text"}))};A.defaultProps={disabled:!1,size:"small"};t.a=A},lRnM:function(e,t,n){"use strict";n.d(t,"f",(function(){return L})),n.d(t,"u",(function(){return k})),n.d(t,"y",(function(){return B})),n.d(t,"z",(function(){return F})),n.d(t,"C",(function(){return q})),n.d(t,"D",(function(){return H})),n.d(t,"E",(function(){return K})),n.d(t,"B",(function(){return W})),n.d(t,"A",(function(){return z})),n.d(t,"v",(function(){return Q})),n.d(t,"w",(function(){return Y})),n.d(t,"x",(function(){return X})),n.d(t,"d",(function(){return J})),n.d(t,"k",(function(){return $})),n.d(t,"l",(function(){return Z})),n.d(t,"n",(function(){return ee})),n.d(t,"m",(function(){return te})),n.d(t,"a",(function(){return ne})),n.d(t,"r",(function(){return re})),n.d(t,"H",(function(){return ae})),n.d(t,"o",(function(){return ie})),n.d(t,"c",(function(){return ce})),n.d(t,"p",(function(){return ue})),n.d(t,"q",(function(){return le})),n.d(t,"M",(function(){return pe})),n.d(t,"t",(function(){return me})),n.d(t,"G",(function(){return fe})),n.d(t,"h",(function(){return Ie})),n.d(t,"j",(function(){return he})),n.d(t,"g",(function(){return be})),n.d(t,"i",(function(){return ye})),n.d(t,"N",(function(){return ve})),n.d(t,"K",(function(){return Oe})),n.d(t,"L",(function(){return ge})),n.d(t,"J",(function(){return Se})),n.d(t,"b",(function(){return Ce})),n.d(t,"s",(function(){return Ne})),n.d(t,"I",(function(){return De})),n.d(t,"F",(function(){return xe})),n.d(t,"e",(function(){return Pe}));n("kYxP");var r=n("oEOe"),a=n("AspN"),s=n("RqPI"),i=n("AQ79"),o=n("/kEJ"),c=n("pXBW"),d=n("hqKg"),u=n("k49u"),l=n("/NU0"),p=n("aWyx"),_=n("WVrH"),m=n("G6rE"),E=n("uKEd"),f=n("xPna"),I=n("k6jb"),h=n("kGix"),b=n("t0aI");const y="ACTION_DM_ADD_PARTICIPANTS",v=r.a(i.b,"ACCEPT_CONVERSATION"),O=r.a(i.b,"MUTE_DM_USER"),g=r.a(i.b,"ADD_PARTICIPANTS"),A=r.a(i.b,"FETCH_CONVERSATION"),S=r.a(i.b,"FETCH_CONVERSATION_FROM_PARTICIPANTS"),T=r.a(i.b,"LEAVE_CONVERSATION"),C=r.a(i.b,"MARK_CONVERSATION_READ"),R=r.a(i.b,"DISABLE_MENTION_CONVERSATION_NOTIFICATIONS"),N=r.a(i.b,"DISABLE_CONVERSATION_NOTIFICATIONS"),M=r.a(i.b,"ENABLE_MENTION_CONVERSATION_NOTIFICATIONS"),D=r.a(i.b,"ENABLE_CONVERSATION_NOTIFICATIONS"),w=r.a(i.b,"UPDATE_CONVERSATION_NAME"),x=r.a(i.b,"UPLOAD_MEDIA"),P=r.a(i.b,"UPDATE_GROUP_AVATAR"),j=(e,t)=>t+36e5*e,U={};function L(e=U,t){switch(t.type){case v.SUCCESS:{const{conversationId:n}=t.meta,r=e[n];return{...e,[n]:{...r,data:{...r.data,trusted:!0}}}}case oe:{const n=Object.entries(t.payload||{}).reduce(((t,[n,r])=>(t[n]={...V(e[n],r),fetchStatus:{[I.a]:h.a.LOADED,[I.b]:h.a.LOADED}},t)),{});return{...e,...n}}case g.REQUEST:{const n=t.meta.conversationId,r=e[n];return{...e,[n]:{...r,fetchStatus:{...r.fetchStatus,[I.b]:h.a.LOADING}}}}case g.FAILURE:{const n=t.meta.conversationId,r=e[n];return{...e,[n]:{...r,fetchStatus:{...r.fetchStatus,[I.b]:h.a.FAILED}}}}case g.SUCCESS:{const n=t.meta.conversationId,r=e[n],a=r.data.participants,s=t.payload.entities.entries?Object.values(t.payload.entities.entries)[0].participants:[];return{...e,[n]:{...r,fetchStatus:{...r.fetchStatus,[I.b]:h.a.LOADED},data:{...r.data,participants:[...a,...s]}}}}case A.REQUEST:{const{conversationId:n,direction:r=I.a}=t.meta,a=e[n];return{...e,[n]:{...a,fetchStatus:{...a&&a.fetchStatus||{},[r]:h.a.LOADING}}}}case A.FAILURE:{const{conversationId:n,direction:r=I.a}=t.meta,a=e[n];return{...e,[n]:{...a,fetchStatus:{...a&&a.fetchStatus||{},[r]:h.a.FAILED},error:t.payload}}}case A.SUCCESS:{const{conversationId:n,direction:r=I.a}=t.meta;return{...e,[n]:{...e[n],fetchStatus:{...e[n]&&e[n].fetchStatus||{},[r]:h.a.LOADED}}}}case de:return Object.entries(e).reduce(((n,[r,a])=>(n[r]=V(e[r],{last_read_event_id:t.payload}),n)),{});case C.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{last_read_event_id:t.meta.lastReadEventId})};case O.SUCCESS:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{muted:t.meta.mute})};case _e:{const{[t.payload]:n,...r}=e;return r}case T.REQUEST:return{...e,[t.meta.conversationId]:{...e[t.meta.conversationId],isDeleted:!0}};case Ee:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{notifications_disabled:!t.payload})};case N.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{notifications_disabled:!0,mute_expiration_time:(n=(new Date).getTime(),[void 0,j(1,n),j(8,n),j(168,n)])[t.meta.duration]})};case R.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{mention_notifications_disabled:!0})};case D.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{notifications_disabled:!1})};case M.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{mention_notifications_disabled:!1})};case Me:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{avatar_image_https:t.payload})};case w.REQUEST:case w.SUCCESS:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{name:t.meta.name})};case Ae:{const n=e[t.meta.conversationId],r=n&&n.data&&n.data.max_entry_id||"0";return Object(b.b)(t.payload,r)?{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{max_entry_id:t.payload})}:e}case x.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{isUploading:!0})};case x.FAILURE:case x.SUCCESS:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{isUploading:!1})};case Te:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{avatarMediaId:t.payload})};case Re:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{avatarMediaId:null})};case _.a:return U;default:return e}var n}const V=(e={},t={},n=[])=>{const{error:r,...a}=e,{avatarMediaId:s=null}=Object(l.a)(t.avatarMediaId)?t:a,{isUploading:i=!1}=t,{avatarMediaId:o,isUploading:c,max_entry_id:d,...u}=t,p={...a&&a.data,...u};p.isSearchResultOnly=!(null!=a&&a.data)&&u.isSearchResult;var _,m;return!!u.conversation_id&&!u.convo_label&&delete p.convo_label,d&&(p.max_entry_id=(_=d,m=a&&a.data&&a.data.max_entry_id,Object(b.c)(_,m)?_:m)),{...a,avatarMediaId:s,data:p,isUploading:i}},k=(e,t)=>e[i.a].conversations[t],B=(e,t)=>{const n=k(e,t);return n&&n.fetchStatus?Object(h.b)(n.fetchStatus,n.data):h.a.LOADED},F=(e,t)=>{const n=k(e,t);return!(!n||!n.fetchStatus)&&Object(h.b)(n.fetchStatus,n.data)===h.a.LOADED},G=(e,t)=>{const n=k(e,t);return!(!n||!n.fetchStatus)&&n.fetchStatus[I.a]===h.a.LOADING},q=Object(d.createSelector)((e=>e[i.a].conversations),(e=>Object.entries(e).reduce(((e,[t,n])=>(n.data&&!n.isDeleted&&(e[t]=n),e)),{}))),H=e=>Object.keys(q(e)).length>0,K=(e,t)=>{if(!t)return;const n=F(e,t),r=Object(f.m)(e,f.b.secondary),a=Object(f.m)(e,f.b.tertiary);return n?r.includes(t)?f.b.secondary:a.includes(t)?f.b.tertiary:f.b.primary:void 0},W=(e,t)=>{const{data:n}=k(e,t)||{},{sort_event_id:r}=n||{};if(r){const t=s.h(e),{message_data:n,by_user_id:a,id:i,sender_id:o}=Object(E.n)(e,r)||{};if(o&&o!==t||n&&n.sender_id!==t||a&&a!==t)return i}return null},z=(e,t)=>{const n=W(e,t),{data:r}=k(e,t)||{};return!n||!!(r&&r.last_read_event_id&&Object(b.c)(r.last_read_event_id,n))},Q=(e,t)=>{const{avatarMediaId:n}=k(e,t)||{};return n},Y=(e,t)=>{const{isUploading:n}=k(e,t)||{};return n},X=(e,t)=>a.i(e,Q(e,t)),J=(e,t)=>(n,a,{api:s})=>{const i=t.join(",");return r.b(n,{params:{conversationId:e,joinedParticipantIds:i},request:s.DirectMessages.addParticipants})({actionTypes:g,context:y,meta:{conversationId:e,participantIds:t}},(e=>{if(e){const{entities:t}=e;return[t.entries&&Object(E.a)(t.entries),Object(o.c)(t)]}})).then((e=>{const t=e.result.failed_participants;if(!t)return Promise.resolve(e);const n=Object.keys(t),r=1===n.length?t[n[0]]:u.a.DefaultApiError,a=new c.a("addParticpants URL",500,e.headers,[{code:r}]);return a.context.action=y,Promise.reject(a)}))},$=(e={})=>(t,n,{api:a})=>{const{conversationId:s,context:i}=e;return r.b(t,{params:e,request:a.DirectMessages.fetchConversation})({actionTypes:A,context:i,meta:{conversationId:s,direction:Object(I.c)(e)}},(e=>{if(e){const{cards:t,entries:n,tweets:r,users:a,fleets:s}=e.entities,{conversations:i,max_entry_id:o,min_entry_id:c,status:d}=e.result.conversation_timeline,u=((e={},t)=>Object.entries(e).reduce(((e,[n,r])=>({...e,[n]:{...r,...t}})),{}))(i,{max_entry_id:o,min_entry_id:c,status:d});return Object(f.c)({conversations:u,entries:n,users:a,tweets:r,cards:t,fleets:s})}}))},Z=e=>(t,n,{api:a})=>r.b(t,{params:{participantIds:e},request:a.DirectMessages.fetchConversationFromParticipants})({actionTypes:S,meta:{participantIds:e}}),ee=(e={})=>(t,n)=>{const r=n(),{conversationId:a}=e,{data:s={}}=k(r,a)||{},i=G(r,a);return(!s.status||s.status===p.c.HAS_MORE)&&!i?t($({conversationId:a,context:"FETCH_DM_CONVERSATION"})):Promise.resolve()},te=(e={})=>(t,n)=>{const r=n(),{conversationId:a}=e,{data:s}=k(r,a)||{},{status:i,min_entry_id:o}=s||{},c=G(r,a);return i!==p.c.HAS_MORE||c?Promise.resolve():t($({...e,max_id:o,context:"FETCH_DM_CONVERSATION_HISTORY"}))},ne=e=>(t,n,{api:a})=>r.b(t,{params:{conversationId:e},request:a.DirectMessages.acceptConversation})({actionTypes:v,meta:{conversationId:e}}),re=(e,t)=>se(e,t,!0),ae=(e,t)=>se(e,t,!1),se=(e,t,n)=>(a,s,{api:i})=>r.b(a,{params:{userId:e,relationshipAction:n?"mute":"unmute",conversationId:t},request:i.DirectMessages.muteDMUser})({actionTypes:O,meta:{userId:e,conversationId:t,mute:n}}).then(a(m.e.patchUser(e,{dm_muting:n}))),ie=(e={})=>(t,n,{api:a})=>{const{conversationId:s}=e;return r.c(t,{params:e,request:a.DirectMessages.leaveConversation})({actionTypes:T,context:"ACTION_LEAVE_CONVERSATION",meta:{conversationId:s}})},oe=i.c("ADD_CONVERSATIONS"),ce=e=>({payload:e,type:oe}),de=i.c("MARK_ALL_AS_READ"),ue=e=>({payload:e,type:de}),le=(e,t)=>({type:C.REQUEST,meta:{conversationId:e,lastReadEventId:t}}),pe=e=>(t,n,{api:a})=>{const s=n(),{data:i={}}=k(s,e)||{},{sort_event_id:o}=i,c=!z(s,e);if(e&&o&&c){return r.c(t,{params:{conversationId:e,last_read_event_id:o},request:a.DirectMessages.markRead})({actionTypes:C,bypassFailureOnErrors:()=>!0,context:"APP_DM_UPDATE_CONVERSATION_READ_STATE",meta:{conversationId:e,lastReadEventId:o}})}return Promise.resolve()},_e=i.c("REMOVE_CONVERSATION"),me=e=>[{payload:e,type:_e},Object(E.i)(e)],Ee=i.c("TOGGLE_CONVERSATION_NOTIFICATIONS"),fe=(e,t)=>({meta:{conversationId:e},payload:t,type:Ee}),Ie=(e={})=>(t,n,{api:a})=>{const{conversationId:s,duration:i}=e;return r.c(t,{params:e,request:a.DirectMessages.disableNotifications})({actionTypes:N,context:"ACTION_DISABLE_NOTIFICATIONS",meta:{conversationId:s,duration:i}})},he=(e={})=>(t,n,{api:a})=>{const{conversationId:s}=e;return r.c(t,{params:e,request:a.DirectMessages.enableNotifications})({actionTypes:D,context:"ACTION_ENABLE_NOTIFICATIONS",meta:{conversationId:s}})},be=(e={})=>(t,n,{api:a})=>{const{conversationId:s}=e,i={mention_notifications_disabled:!0,...e};return r.c(t,{params:i,request:a.DirectMessages.updateMentionNotificationsSetting})({actionTypes:R,context:"ACTION_DISABLE_DM_MENTION_NOTIFICATIONS",meta:{conversationId:s}})},ye=(e={})=>(t,n,{api:a})=>{const{conversationId:s}=e,i={mention_notifications_disabled:!1,...e};return r.c(t,{params:i,request:a.DirectMessages.updateMentionNotificationsSetting})({actionTypes:M,context:"ACTION_ENABLE_DM_MENTION_NOTIFICATIONS",meta:{conversationId:s}})},ve=(e={})=>(t,n,{api:r})=>r.DirectMessages.updateTyping(e),Oe=(e={})=>(t,n,{api:a})=>{const{conversationId:s,name:i}=e;return r.c(t,{params:e,request:a.DirectMessages.updateConversationName})({actionTypes:w,context:"ACTION_UPDATE_CONVERSATION_NAME",meta:{conversationId:s,name:i}})},ge=e=>({type:w.SUCCESS,meta:{conversationId:e.conversation_id,name:e.conversation_name}}),Ae=i.c("UPDATE_CONVERSATION_MAX_ENTRY_ID"),Se=(e,t)=>({meta:{conversationId:e},payload:t,type:Ae}),Te=i.c("ADD_AVATAR_MEDIA"),Ce=(e,t)=>({meta:{conversationId:e},payload:t,type:Te}),Re=i.c("REMOVE_AVATAR_MEDIA"),Ne=(e,t)=>({meta:{conversationId:e},payload:t,type:Re}),Me=i.c("UPDATE_CONVERSATION_AVATAR"),De=(e,t)=>({meta:{conversationId:e},payload:t,type:Me}),we="APP_DM_UPDATE_CONVERSATION_AVATAR",xe=e=>(t,n,{api:s})=>{t({meta:{conversationId:e},type:x.REQUEST});const i=Q(n(),e),o=a.m(i);return t(o).then((([n])=>{t({meta:{conversationId:e},type:x.SUCCESS});return r.b(t,{params:{conversationId:e,avatar_id:n.uploadId},request:s.DirectMessages.updateConversationAvatar})({actionTypes:P,context:we})}),(n=>{const r={errors:n,context:we};return t({meta:{conversationId:e},type:x.FAILURE}),Promise.reject(r)}))},Pe=(e,t)=>(n,a,{api:s})=>r.d(n,{params:{conversation_id:e,welcome_message_id:t},request:s.DirectMessages.addWelcomeMessageToConversation})("ADD_WELCOME_MESSAGE_TO_CONVERSATION")},oEoC:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return c}));n("kYxP");var r=n("kIAd");function a(e,t){let n;const a=r.b.scoper.find((r=>{if(-1!==r.srcInputs.indexOf(t))return n=e.match(r.regexp),n}));let s="";return n&&(s=n&&(1===n.length?n[0]:n[1])),a?{...a.scope,src:t,q:s}:null}function s(e,t){const n=t.slice(0,e),a=t.slice(e,t.length),s=n.search(r.b.WordEnd),i=s>=0?n.slice(s):"",o=a.search(r.b.WordBoundary),c=i+a.slice(0,o);return c.trim()?{start:s,end:e+o,word:c}:{start:-1,end:-1,word:""}}function i(){return`typeaheadFocus-${Math.random()}`}function o(e){const{altKey:t,ctrlKey:n,metaKey:r}=e;return!(t||n||r)}function c(e,t){const n=[];e.forEach((e=>{const r=t.find((t=>t.id===e.id));r&&r.data&&r.data.result_context?n.push(r):n.push(e)}));const r=n.map((e=>e.id)),a=t.filter((e=>r.indexOf(e.id)<0));return[...n,...a]}},pKoL:function(e,t,n){"use strict";var r=n("KEM+"),a=n.n(r),s=(n("kYxP"),n("ERkP")),i=n("HPNB"),o=n("9HgX"),c=n("3XMw"),d=n.n(c),u=n("LCtV"),l=n("k/Ka"),p=n("eXeu"),_=n("iOGT");class m extends s.Component{constructor(...e){super(...e),a()(this,"_setVideoRef",(e=>{const{getVideoRef:t}=this.props;t&&t(e)}))}render(){const{children:e,dataSaverMode:t,getVideoRef:n,style:r,variants:a,...i}=this.props,o=Object(_.b)(a,t?_.a.MEDIUM:_.a.HIGH)||[],c=Object(p.e)(o.map((e=>({src:e.url,type:e.content_type}))));return Object(l.a)("video",{...i,children:[c.map((e=>s.createElement("source",{key:e.src,src:e.src,type:e.type}))),e],ref:this._setVideoRef,style:r})}}a()(m,"defaultProps",{dataSaverMode:!1,variants:[]});var E=n("sjK1"),f=n("cHvH"),I=n("mXq/"),h=n("/yvb"),b=n("a6qo"),y=n("rHpw"),v=n("hOZg"),O=n("tuke"),g=n("U+bB"),A=n("MWbm"),S=n("+/sI");const T=d.a.gd80afba,C=d.a.abd845fd,R=d.a.df1b0707,N=d.a.cd959e5b,M=d.a.e68b09b4,D=d.a.add55c97;class w extends s.Component{constructor(...e){super(...e),a()(this,"state",{isVideoPaused:!0,playGif:!1}),a()(this,"_handleGifClick",(()=>{this.setState({playGif:!this.state.playGif})})),a()(this,"_handleMediaPreviewLayout",(e=>{const{mediaItem:t,resizeIfNeeded:n}=this.props,r=t.mediaFile||t.externalMediaDetails;if(!r)return;const{nativeEvent:{layout:{height:a,width:s}}}=e,{height:i,width:o}=r,c=o/i;Math.abs(c-s/a)>.05&&this._mediaContainer&&("width"===n?this._mediaContainer.setNativeProps({style:{width:a*c}}):"height"===n&&this._mediaContainer.setNativeProps({style:{height:s/c}}))})),a()(this,"_handleVideoOnPlay",(e=>{this.setState({isVideoPaused:!1})})),a()(this,"_handleVideoOnPause",(e=>{this.setState({isVideoPaused:!0})})),a()(this,"_setMediaContainerRef",(e=>{this._mediaContainer=e})),a()(this,"_setVideoRef",(e=>{this._video=e})),a()(this,"_playVideo",(()=>{if(this._video){const e=this._video.play();void 0!==e&&e.then((e=>{this._handleVideoOnPlay()})).catch()}})),a()(this,"_pauseVideo",(()=>{this._video&&(this._video.pause(),this._handleVideoOnPause())}))}render(){const{accessibilityLabel:e,accessibilityRole:t,enableGif:n,mediaItem:r,onEdit:a,onRemove:c,style:d,withAltTextLabel:u,withCloseButton:l,withEditButton:p}=this.props,{playGif:_}=this.state,m=r.externalMediaDetails&&r.externalMediaDetails.mediaType===o.a,E=m||n&&r.mediaFile&&r.mediaFile.isGif;return s.createElement(f.a,null,(({windowWidth:n})=>{const r=i.a.isTwoColumnLayout(n);return s.createElement(A.a,{accessibilityLabel:e||D,accessibilityRole:t,onLayout:this._handleMediaPreviewLayout,ref:this._setMediaContainerRef,style:[d,x.cursor,m&&x.gifPlayButton]},this._renderPreview(),m&&!_&&s.createElement(I.a,{accessibilityLabel:R,onPress:this._handleGifClick,size:"small"}),l?s.createElement(h.a,{accessibilityLabel:N,hoverLabel:{label:M},icon:s.createElement(v.a,null),onPress:c,size:"small",style:x.close,type:"onMedia"}):null,E?s.createElement(S.c,{type:S.a}):null,u?s.createElement(b.a,{align:"left",bold:!0},"ALT"):null,p?s.createElement(h.a,{accessibilityLabel:T,icon:r?void 0:s.createElement(O.a,null),onPress:a,size:r?"normalCompact":"small",style:x.edit,type:"onMedia"},r&&C):null)}))}_renderPreview(){const{mediaItem:e}=this.props;if(e.externalMediaDetails){const t=e.externalMediaDetails.previewUrl,n=e.externalMediaDetails.stillMediaUrl;return this._renderGifPreview(t,n)}if(e.mediaFile&&e.mediaFile.isVideo){const t=[{content_type:e.mediaFile.type,url:e.mediaFile.url}];return this._renderVideoPreview(t)}return s.createElement(A.a,{style:y.a.absoluteFill},this._renderImagePreview())}_renderGifPreview(e,t){const{playGif:n}=this.state,r={uri:n?e:t};return s.createElement(A.a,{onClick:this._handleGifClick,style:y.a.absoluteFill},s.createElement(g.a,{resizeMode:"cover",source:r,style:x.video}))}_renderImagePreview(){const{borderRadius:e,enableGif:t,mediaItem:n,onClick:r}=this.props;return s.createElement(u.b,{borderRadius:e,enableGif:t,mediaItem:n,onClick:r})}_renderVideoPreview(e){const{mediaItem:{mediaFile:t}}=this.props;return s.createElement(m,{autoPlay:!1,controls:!0,getVideoRef:this._setVideoRef,loop:!0,muted:!0,onPause:this._handleVideoOnPause,onPlay:this._handleVideoOnPlay,playsInline:!0,poster:t instanceof E.c?t.thumbnail:"",style:x.video,variants:e})}}a()(w,"defaultProps",{enableGif:!0,withCloseButton:!0,withAltTextLabel:!1,withEditButton:!1});const x=y.a.create((e=>({close:{position:"absolute",left:e.spaces.space4,top:e.spaces.space4},cursor:{cursor:"pointer"},edit:{position:"absolute",right:e.spaces.space4,top:e.spaces.space4},gifPlayButton:{alignItems:"center",justifyContent:"center"},video:{height:"100%",width:"100%"}})));t.a=w},rFBM:function(e,t,n){"use strict";var r=n("KEM+"),a=n.n(r),s=(n("kYxP"),n("ERkP")),i=n("rHpw"),o=n("k/Ka"),c=n("MWbm");const d=e=>Object(o.a)("div",e);class u extends s.Component{constructor(...e){super(...e),a()(this,"_dragEnterCount",0),a()(this,"state",{active:!1}),a()(this,"_handleDragDrop",(e=>{const{onFilesAdded:t}=this.props;e.preventDefault();t(Array.from(e&&e.dataTransfer.files)),this._updateDragCount(0)})),a()(this,"_handleDragEnter",(e=>{const{onDragEnter:t}=this.props;e.preventDefault(),t&&t(),this._updateDragCount(this._dragEnterCount+1)})),a()(this,"_handleDragLeave",(e=>{e.preventDefault(),this._updateDragCount(this._dragEnterCount-1)})),a()(this,"_handleDragOver",(e=>{e.preventDefault()}))}render(){const{allowDragDrop:e,children:t,style:n}=this.props,{active:r}=this.state,a=e?l.dragBorderValid:l.dragBorderInvalid;return s.createElement(d,{onDragEnter:this._handleDragEnter,onDragLeave:this._handleDragLeave,onDragOver:this._handleDragOver,onDrop:this._handleDragDrop,style:[l.root,n,r&&a]},s.createElement(c.a,{style:l.inner},"function"==typeof t?t(r):t))}_updateDragCount(e){this._dragEnterCount=e,0===this._dragEnterCount?this.setState({active:!1}):this._dragEnterCount>0&&this.setState({active:!0})}}a()(u,"defaultProps",{allowDragDrop:!0});const l=i.a.create((e=>({root:{display:"flex",flexDirection:"column"},dragBorderValid:{borderStyle:"dashed",borderWidth:e.spaces.space2,borderColor:e.colors.primary},dragBorderInvalid:{borderStyle:"dashed",borderWidth:e.spaces.space2,borderColor:e.colors.red500},inner:{flexGrow:1}})));t.a=u},tuke:function(e,t,n){"use strict";var r=n("ERkP"),a=n("Lsrn"),s=n("k/Ka");const i=(e={})=>Object(s.a)("svg",{...e,style:[a.a.root,e.style],viewBox:"0 0 24 24"},r.createElement("g",null,r.createElement("path",{d:"M21.592 5.576c.877-.967.882-2.298.006-3.174-.877-.877-2.208-.87-3.174.006 0 0-.003 0-.004.002l-.006.006-.005.004s-.002 0-.002.002L8.398 11.27c-1.716-.214-3.424.31-4.534 1.42-3.872 3.874-1.523 9.616-1.422 9.858.1.24.32.41.577.45.037.007.075.01.113.01.218 0 .428-.095.57-.265 1.83-2.15 3.043-2.023 4.328-1.89 1.164.122 2.477.258 3.834-1.282.975-1.106 1.302-2.585.922-4.03l8.792-9.948h.002l.004-.006.006-.006.002-.004zm-1.055-2.113c.305.305.28.74-.06 1.11-.003.003-.004.007-.006.01 0 0-.003 0-.004.003l-5.662 6.406-1.796-1.796 6.406-5.662c.002 0 .002-.003.004-.005.002-.003.006-.004.008-.006.37-.34.807-.365 1.11-.06zm-8.62 10.797L9.74 12.084l2.142-1.894 1.927 1.927-1.894 2.143zm-1.178 4.32c-.848.96-1.488.895-2.552.78-1.27-.13-2.808-.293-4.722 1.463-.415-1.673-.784-4.83 1.457-7.072.807-.805 2.086-1.168 3.377-.983l2.977 2.976c.333 1.03.15 2.057-.538 2.836z"})));i.metadata={width:24,height:24},t.a=i},uKEd:function(e,t,n){"use strict";n.d(t,"e",(function(){return O})),n.d(t,"a",(function(){return T})),n.d(t,"f",(function(){return C})),n.d(t,"d",(function(){return R})),n.d(t,"k",(function(){return N})),n.d(t,"i",(function(){return D})),n.d(t,"r",(function(){return w})),n.d(t,"h",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"j",(function(){return L})),n.d(t,"c",(function(){return k})),n.d(t,"g",(function(){return F})),n.d(t,"l",(function(){return G})),n.d(t,"n",(function(){return q})),n.d(t,"o",(function(){return H})),n.d(t,"m",(function(){return K})),n.d(t,"p",(function(){return W})),n.d(t,"q",(function(){return z}));n("kYxP");var r=n("t0aI"),a=n("aWyx"),s=n("SrIh"),i=n("WVrH"),o=n("fEA7"),c=n.n(o),d=n("AQ79"),u=n("3A2y"),l=n("J4ZH"),p=n("4FGy"),_=n("s1N3"),m=n("lnti"),E=n("oEOe");const f=Object(E.a)(d.b,"DELETE_MESSAGE"),I=Object(E.a)(d.b,"REACTION_CREATE"),h=Object(E.a)(d.b,"REACTION_DELETE"),b=Object(E.a)(d.b,"MARK_ENTRIES_AS_SPAM"),y=Object(E.a)(d.b,"MARK_ENTRIES_AS_NOT_SPAM"),v={entries:{},entryIdsByConversationId:{},reactionsByMessageId:{}};function O(e=v,t){const{conversationId:n,requestId:r}=t.meta||{};switch(t.type){case P:{const{id:r}=t.payload,a={...e.entries,[r]:g(e.entries[r],{data:t.payload})};return{...e,entries:a,entryIdsByConversationId:{...e.entryIdsByConversationId,[n]:A([...e.entryIdsByConversationId[n]||[],r],a)}}}case S:{const n=Object.values(t.payload).filter((e=>e.type!==a.b.CONVERSATION_READ)).reduce(((t,n)=>{const{id:r}=n,s=Object(u.a)(n,"message_reactions");return t.allEntries[r]=g(e.entries[r],{data:s,isLoading:!1,isLoaded:!0}),n.message_reactions&&(n.message_reactions.forEach((r=>{const s={...r,affects_sort:!0,message_id:n.id,type:a.b.REACTION_CREATE};t.allEntries[s.id]=g(e.entries[s.id],{data:s,isLoading:!1,isLoaded:!0})})),t.embeddedReactionsByMessageId[r]=A([...e.reactionsByMessageId[r]||[],...n.message_reactions.map((e=>e.id))],{...e.entries,...t.allEntries})),t}),{allEntries:{},embeddedReactionsByMessageId:{}}),r={...e.entries,...n.allEntries},s=Object(l.a)(Object.values(n.allEntries),(e=>e.data.conversation_id)),i=Object.keys(s).reduce(((t,n)=>{const a=s[n].map((e=>e.data.id));return t[n]=A([...e.entryIdsByConversationId[n]||[],...a],r),t}),{});return{...e,entries:r,entryIdsByConversationId:{...e.entryIdsByConversationId,...i},reactionsByMessageId:{...e.reactionsByMessageId,...n.embeddedReactionsByMessageId}}}case b.REQUEST:case y.REQUEST:{const n=t.type===b.REQUEST,r=t.payload.reduce(((t,r)=>{const a=e.entries[r]&&e.entries[r].data;return{...t,[r]:{...e.entries[r],data:{...a,marked_as_spam:n}}}}),{});return{...e,entries:{...e.entries,...r}}}case f.REQUEST:case M:{const r=t.type===M&&!Array.isArray(t.payload),a=e.entryIdsByConversationId[n]||[],s=t.type===M?r?a:t.payload:[t.payload,...e.reactionsByMessageId[t.payload]||[]];return{...e,entries:Object(u.a)(e.entries,s),entryIdsByConversationId:{...Object(u.a)(e.entryIdsByConversationId,n),...r?{}:{[n]:Object(p.a)(a,s)}},reactionsByMessageId:Object(u.a)(e.reactionsByMessageId,s)}}case U:{const a=t.payload.id||r,s={...Object(u.a)(e.entries,a)},i=A((e.entryIdsByConversationId[n]||[]).filter((e=>e!==a)),s),o=i?{[n]:i}:{};return{...e,entries:s,entryIdsByConversationId:{...Object(u.a)(e.entryIdsByConversationId,n),...o},reactionsByMessageId:Object(u.a)(e.reactionsByMessageId,a)}}case V:{const n=t.payload,r=[...e.reactionsByMessageId[n.message_id]||[],n.id],a=r.filter((t=>e.entries[t]));r.length!==a.length&&Object(s.a)("DM add reaction is missing a backing entry",{extra:{filteredMessageReactionIds:a,messageReactionIds:r,currentId:n.id}});const i=A(a,e.entries);return{...e,reactionsByMessageId:{...e.reactionsByMessageId,[n.message_id]:i}}}case h.REQUEST:case B:{const n=t.payload,r=(e.reactionsByMessageId[n.message_id]||[]).find((t=>e.entries[t].data.sender_id===n.sender_id));if(!r)return e;const a=Object(p.a)(e.entryIdsByConversationId[n.conversation_id],r),s=Object(p.a)(e.reactionsByMessageId[n.message_id],r);return{...e,entries:Object(u.a)(e.entries,r),entryIdsByConversationId:{...e.entryIdsByConversationId,[n.conversation_id]:a},reactionsByMessageId:{...e.reactionsByMessageId,[n.message_id]:s}}}case i.a:return v;default:return e}}const g=(e,t)=>{const{error:n,isLoaded:r,isLoading:a,...s}=e||{},{data:i,...o}=t||{};return{...s,data:{...s&&s.data,...i},...o}},A=(e=[],t)=>{const n=Object(_.a)(e).sort(((e,n)=>{const a=Object(r.a)(t[e].data.time,t[n].data.time);return 0===a?Object(r.a)(t[e].id,t[n].id):a}));return n.length?n:void 0},S=Object(d.c)("ADD_ENTRIES"),T=e=>({payload:e,type:S}),C=e=>(t,n,{api:r})=>{const{id:a,conversationId:s,requestId:i=c.a.v1(),...o}=e||{},d={...o,id:a,request_id:i};return Object(E.c)(t,{params:d,request:r.DirectMessages.deleteMessage})({actionTypes:f,context:"ACTION_DELETE_DM",payload:a,meta:{conversationId:s}})},R=e=>(t,n,{api:r})=>{const s=(({reaction_key:e,conversation_id:t,dm_id:n,perspective:r})=>({id:c.a.v1(),time:(new Date).getTime().toString(),reaction_key:e,conversation_id:t,message_id:n,sender_id:r,type:a.b.REACTION_CREATE}))(e);t([j(s.conversation_id,s.id,s),F(s),k(s)]);return Object(E.b)(t,{params:Object(u.a)(e,"perspective"),request:r.DirectMessages.addReaction})({actionTypes:I,context:"ACTION_REACTION_CREATE"},((e,t)=>{if(t)return[F(s)]}))},N=e=>(t,n,{api:r})=>{const{perspective:a,...s}=e;return Object(E.c)(t,{params:s,request:r.DirectMessages.deleteReaction})({actionTypes:h,context:"ACTION_REACTION_DELETE",payload:{conversation_id:e.conversation_id,message_id:e.dm_id,sender_id:a}})},M="rweb/dm/REMOVE_CONVERSATION_ENTRIES",D=(e,t)=>({meta:{conversationId:e},payload:t,type:M}),w=(e,t)=>({payload:e,type:t?b.REQUEST:y.REQUEST}),x=({conversationId:e,dmId:t,markSpam:n})=>(r,a,{api:s})=>Object(E.c)(r,{params:{dm_id:t,report_as:n?"spam":"not_spam"},request:s.DirectMessages.reportSpam})({actionTypes:n?f:y,payload:n?t:[t],meta:{conversationId:e}}),P=Object(d.c)("ADD_ENTRY"),j=(e,t,n)=>({meta:{conversationId:e,requestId:t},payload:n,type:P}),U=Object(d.c)("REMOVE_ENTRY"),L=(e,t,n)=>({meta:{conversationId:e,requestId:t},payload:n,type:U}),V=Object(d.c)("ADD_REACTION"),k=e=>({payload:e,type:V}),B=Object(d.c)("DELETE_REACTION"),F=e=>({payload:e,type:B}),G=e=>e[d.a].entries,q=(e,t)=>{const n=G(e).entries[t];return n&&n.data},H=(e,t)=>e[d.a].entries.entryIdsByConversationId[t],K=(e,t)=>{const n=H(e,t);return n?Object(m.a)(n.map((t=>q(e,t)))):[]},W=(e,t)=>G(e).reactionsByMessageId[t],z=(e,t)=>(W(e,t)||[]).map((t=>q(e,t).sender_id))},ude7:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("A0bJ"),a=n("hJBK"),s=n("1auM");const i=1,o=2,c=3,d=e=>{if(Object(s.b)(e)){if(e.isGif){const{img:t,width:n,height:s,orientation:i}=e;return Object(a.b)(t,n,s,i).then((e=>Object(a.a)(e)),(e=>{throw new r.a("Gif preview could not be generated",c)}))}{const e=new r.a("The provided image must be a gif",o);return Promise.reject(e)}}{const e=new r.a("The provided file is not a valid image",i);return Promise.reject(e)}}},w3n3:function(e,t,n){"use strict";var r=n("ERkP"),a=n("/yvb"),s=(n("MLl7"),n("3XMw")),i=n.n(s),o=n("3rWK"),c=n("Irs7");const d=i.a.a4993fa1,u=r.createElement(o.a,null),l=i.a.i0db46e6;t.a=({dmConversationId:e,enabled:t=!0,gifSearchKeySource:n,history:s,style:i,onPress:o})=>{const p=Object(c.b)(),_=r.useCallback((()=>{o&&o(),p.scribe({element:"found_media_button",action:"click"}),s.push({pathname:"/i/foundmedia/search",state:{gifSearchKeySource:n,dmConversationId:e}})}),[e,p,n,s,o]);return r.createElement(a.a,{accessibilityLabel:d,disabled:!t,hoverLabel:{label:l},icon:u,onPress:_,size:"normal",style:[i],type:"text"})}},wpu3:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return _})),n.d(t,"d",(function(){return m}));n("kYxP");var r=n("oEoC"),a=n("1auM"),s=(n("S1qy"),n("kIAd")),i=n("VAyw"),o=n("/Ikv"),c=n("s1N3"),d=n("lnti");const u=({inReplyToStatus:e,loggedInUserId:t,excludeReplyUser:n})=>{const{retweeted_status:r}=e,{entities:a}=r||e,{user:s}=e.retweeted_status||e,o=r?r.user:{},u=r?e.user:{},p=(null==a?void 0:a.user_mentions)||[],_=i.a.mergeTaggedUsers((null==a?void 0:a.media)||[]),m=l(r||e)||{},E={[o.id_str]:o,[u.id_str]:u,[s.id_str]:s,[m.id_str]:m};p.forEach((e=>{E[e.id_str]=e})),_.forEach((({user_id:e,name:t,screen_name:n})=>{E[e]={id_str:e,name:t,screen_name:n}}));const f=Object(c.a)(Object(d.a)([o.id_str,u.id_str,s.id_str,...p.map((e=>e.id_str)),..._.map((e=>e.user_id))])).filter((e=>e!==t));let I=t&&s.id_str===t?[t,...f]:f;return n&&(I=I.filter((e=>e!==s.id_str))),I.map((e=>E[e]))},l=({card:e})=>{let t=null;if(e){const n=o.a.getBindingValue(e.binding_values,"site");n&&e.users&&(t=e.users[n.id_str])}return t},p=({maxNumberOfPhotos:e})=>t=>{if(0===t.length)return!0;const n=t.some((e=>!!e.externalMediaDetails)),r=!n&&t.some((e=>e.mediaFile&&e.mediaFile.isGif)),s=t.some((e=>e.mediaFile&&!(e.mediaFile instanceof a.a)&&e.mediaFile.isVideo));if(r||n||s)return 1===t.length;{const n=t.length<=e,r=t.every((e=>e.mediaFile&&e.mediaFile.isImage));return n&&r}},_=p({maxNumberOfPhotos:4}),m=(e,t=!1)=>{const n=e.split(s.b.WordBoundary);return t&&n.pop(),!!n.find((e=>{const t=Object(r.d)(e,"compose");return t&&"users"===t.result_type}))}},xCUF:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return E})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return O}));n("kYxP");var r=n("oEOe"),a=n("aWyx"),s=n("k6jb"),i=n("AQ79"),o=n("uKEd"),c=n("xPna"),d=n("lRnM"),u=n("WVrH"),l=n("P1r1");const p=r.a(i.b,"FETCH_UPDATES"),_={isLoaded:!1,isLoading:!1};function m(e=_,t){switch(t.type){case p.REQUEST:return{...e,isLoading:!0};case p.FAILURE:return{...e,error:t.payload,isLoaded:!1,isLoading:!1};case p.SUCCESS:{const{error:t,...n}=e;return{...n,isLoaded:!0,isLoading:!1}}case I:return{...e,cursor:t.payload};case b:return{...e,tertiaryInboxStatus:t.payload};case u.a:return _;default:return e}}const E=e=>(t,n,{api:a})=>{const i=n(),{directMessages:o={}}=i;let{cursor:d}=o.updates||{};const{polling:_,...m}=e||{},{tertiaryInboxStatus:E}=o.updates||{};let f=!1;const I=_?{"x-twitter-polling":"true"}:{},h=Object(l.p)(i);if(window.location.pathname.startsWith("/i/report"))return Promise.resolve();const b=[Object(l.r)(n())?"on":"off",h?"on":"off"].join();E?E!==b&&(d=null,f=!0):f=!0;const O=Object(c.j)({...m,muting_enabled:!0,nsfw_filtering_enabled:h,cursor:d},n());return r.b(t,{params:O,headers:I,request:a.DirectMessages.fetchUserUpdates})({actionTypes:p,context:"FETCH_DM_USER_UPDATES",meta:{direction:Object(s.c)(e)}},(e=>{if(e){const{entries:t,tweets:n,users:r,cards:a,fleets:s}=e.entities,{user_events:i,inbox_initial_state:o}=e.result;return[o&&Object(u.b)(),...Object(c.c)({...i||o,entries:t,users:r,tweets:n,cards:a,fleets:s}),...i?v(Object.values(t||[])):[],f&&y(b)]}}))},f=e=>(t,n)=>g(n())?Promise.resolve():t(E(e)),I=Object(i.c)("UPDATE_CURSOR"),h=e=>({payload:e,type:I}),b=Object(i.c)("UPDATE_TERTIARY_INBOX_STATUS"),y=e=>({payload:e,type:b}),v=(e=[])=>e.sort(((e,t)=>e.id-t.id)).reduce(((e,t)=>{switch(t.type){case a.b.CONVERSATION_AVATAR_UPDATE:return[...e,Object(d.I)(t.conversation_id,t.conversation_avatar_image_https),Object(d.J)(t.conversation_id,t.id)].filter((e=>e));case a.b.CONVERSATION_NAME_UPDATE:return[...e,Object(d.L)(t),Object(d.J)(t.conversation_id,t.id)].filter((e=>e));case a.b.CONVERSATION_READ:return[...e,Object(d.q)(t.conversation_id,t.last_read_event_id)];case a.b.DISABLE_NOTIFICATIONS:case a.b.ENABLE_NOTIFICATIONS:{const n=t.type===a.b.ENABLE_NOTIFICATIONS;return[...e,Object(d.G)(t.conversation_id,n)]}case a.b.MARK_ALL_AS_READ:return[...e,Object(d.p)(t.last_read_event_id)];case a.b.MESSAGE_DELETE:return[...e,Object(o.i)(t.conversation_id,t.messages.reduce(((e,t)=>[...e,...Object.values(t)]),[]))];case a.b.MESSAGE_MARK_AS_NOT_SPAM:case a.b.MESSAGE_MARK_AS_SPAM:{const n=t.type===a.b.MESSAGE_MARK_AS_SPAM;return[...e,Object(o.r)(t.messages.reduce(((e,t)=>[...e,...Object.values(t)]),[]),n)]}case a.b.REMOVE_CONVERSATION:return[...e,...Object(d.t)(t.conversation_id)];case a.b.JOIN_CONVERSATION:case a.b.PARTICIPANTS_JOIN:case a.b.PARTICIPANTS_LEAVE:return[...e,Object(d.J)(t.conversation_id,t.id)];case a.b.REACTION_CREATE:return[...e,Object(o.g)(t),Object(o.c)(t),Object(d.J)(t.conversation_id,t.id)];case a.b.REACTION_DELETE:return[...e,Object(o.g)(t)];case a.b.MESSAGE:return[...e,Object(d.J)(t.conversation_id,t.id)].filter((e=>e));default:return e}}),[]),O=e=>e[i.a].updates,g=e=>O(e).isLoading},xPna:function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return S})),n.d(t,"d",(function(){return C})),n.d(t,"j",(function(){return M})),n.d(t,"s",(function(){return P})),n.d(t,"o",(function(){return j})),n.d(t,"n",(function(){return U})),n.d(t,"v",(function(){return L})),n.d(t,"x",(function(){return V})),n.d(t,"p",(function(){return k})),n.d(t,"r",(function(){return B})),n.d(t,"q",(function(){return F})),n.d(t,"m",(function(){return H})),n.d(t,"t",(function(){return K})),n.d(t,"y",(function(){return W})),n.d(t,"u",(function(){return z})),n.d(t,"w",(function(){return Q})),n.d(t,"e",(function(){return X})),n.d(t,"f",(function(){return J})),n.d(t,"h",(function(){return Z})),n.d(t,"i",(function(){return ee})),n.d(t,"g",(function(){return te})),n.d(t,"c",(function(){return ae})),n.d(t,"B",(function(){return se})),n.d(t,"C",(function(){return ie})),n.d(t,"A",(function(){return oe})),n.d(t,"l",(function(){return de})),n.d(t,"z",(function(){return pe})),n.d(t,"k",(function(){return _e}));n("kYxP");var r=n("oEOe");var a=n("/kEJ"),s=n("uKEd"),i=n("4q8G"),o=n("kGix"),c=n("aWyx"),d=n("WVrH"),u=n("xCUF"),l=n("AQ79"),p=n("lRnM"),_=n("tn7R"),m=n("YeIG"),E=n("t0aI"),f=n("P1r1");const I="rweb.dmDrawerVisibility",h=r.a(l.b,"FETCH_INBOX"),b=r.a(l.b,"UPDATE_LAST_SEEN_EVENT_ID"),y="inbox",v="trusted",O="untrusted",g="untrusted_low_quality",A=Object.freeze({CLOSED:"closed",COLLAPSED:"collapsed",EXPANDED:"expanded"}),S={primary:"primary",secondary:"secondary",tertiary:"tertiary"},T={cursors:{[y]:{fetchStatus:o.a.NONE},[v]:{fetchStatus:o.a.NONE},[O]:{fetchStatus:o.a.NONE},[g]:{fetchStatus:o.a.NONE}},lastSeenEventIds:{},poppedOutConversationId:null,drawerVisibility:A.COLLAPSED,drawerExperimentEnabled:!1};function C(e=T,t){switch(t.type){case h.REQUEST:{const{timelineType:n}=t.meta;return{...e,cursors:{...e.cursors,[n]:{...e.cursors[n],fetchStatus:o.a.LOADING}}}}case h.FAILURE:{const{timelineType:n}=t.meta;return{...e,cursors:{...e.cursors,[n]:{...e.cursors[n],error:t.payload,fetchStatus:o.a.FAILED}}}}case h.SUCCESS:{const{timelineType:n}=t.meta;return{...e,cursors:{...e.cursors,[n]:{...e.cursors[n],error:void 0,fetchStatus:o.a.LOADED}}}}case ne:return{...e,cursors:{...e.cursors,...t.payload.cursors},lastSeenEventIds:R(e.lastSeenEventIds,t.payload.lastSeenEventIds)};case b.REQUEST:return{...e,lastSeenEventIds:{...e.lastSeenEventIds,...t.meta.lastSeenEventIds}};case d.a:return{...T,cursors:{...T.cursors,inbox:e.cursors.inbox}};case ce:return{...e,poppedOutConversationId:t.conversationId,drawerVisibility:A.EXPANDED};case ue:return{...e,drawerVisibility:t.visibility};default:return e}}const R=(e,t)=>({last_seen_event_id:N(e.last_seen_event_id,t.last_seen_event_id),trusted_last_seen_event_id:N(e.trusted_last_seen_event_id,t.trusted_last_seen_event_id),untrusted_last_seen_event_id:N(e.untrusted_last_seen_event_id,t.untrusted_last_seen_event_id)}),N=(e,t)=>Object(E.c)(e,t)?e:t,M=(e,t,n="all")=>{const r=Object(f.r)(t),a=Object(f.q)(t);return r?{...e,filter_low_quality:a,include_quality:n}:e},D=e=>e[l.a].inbox,w=e=>D(e).cursors,x=e=>D(e).lastSeenEventIds,P=e=>D(e).poppedOutConversationId,j=e=>D(e).drawerVisibility,U=e=>D(e).drawerExperimentEnabled,L=e=>w(e)[O],V=e=>w(e)[g],k=e=>(e=>w(e)[y])(e).fetchStatus,B=e=>k(e)===o.a.LOADING,F=e=>k(e)===o.a.LOADED,G={[S.primary]:e=>e.trusted,[S.secondary]:(e,t,n)=>t?!(e.trusted||e.muted||n&&e.nsfw||e.low_quality):!(e.trusted||e.muted||n&&e.nsfw),[S.tertiary]:(e,t,n)=>t?!e.trusted&&(e.muted||e.low_quality||n&&e.nsfw):!e.trusted&&(e.muted||n&&e.nsfw)},q=(e,t)=>{const n=Object(f.q)(e),r=Object(f.p)(e);return Object(_.a)(Object(p.C)(e)).filter((e=>G[t](e.data,n,r)))},H=(e,t)=>q(e,t).map((e=>e.data)).sort(i.a).map((e=>e.conversation_id)),K=e=>{const t=q(e,S.primary),n=q(e,S.secondary),r=t.concat(n),{last_seen_event_id:a}=x(e);return Y(e,r,a)},W=e=>{const t=q(e,S.secondary),{untrusted_last_seen_event_id:n}=x(e);return Y(e,t,n)},z=e=>{const t=q(e,S.secondary),n=q(e,S.tertiary);return t.length+n.length},Q=e=>q(e,S.tertiary).length,Y=(e,t,n)=>n?t.reduce(((t,{data:{conversation_id:r}})=>{const a=Object(p.B)(e,r),s=Object(p.A)(e,r);return a&&Object(E.b)(a,n)&&!s?t+1:t}),0):0,X=(e={})=>(t,n,{api:a})=>{const s=n(),i=Object(f.p)(s),o=M({muting_enabled:!0,nsfw_filtering_enabled:i,...e},n());return r.b(t,{params:o,request:a.DirectMessages.fetchUserInbox})({actionTypes:h,context:"FETCH_DM_INBOX",meta:{timelineType:y}},(e=>{if(e){const{entries:t,users:n,tweets:r,cards:a,fleets:s}=e.entities;return ae({...e.result.inbox_initial_state,entries:t,users:n,tweets:r,cards:a,fleets:s})}}))},J=(e={})=>(t,n)=>{const r=n(),a=k(r);return a!==o.a.LOADED&&a!==o.a.LOADING?t(X(e)):Promise.resolve()},$=(e,t,n=0)=>(a,s,{api:i})=>{const o=s(),d=Object(f.p)(o),{status:u,min_entry_id:l}=w(o)[e],p=e===g?O:e,_={...t,max_id:l,timelineType:p,muting_enabled:e!==v,nsfw_filtering_enabled:d};if(u!==c.c.HAS_MORE)return Promise.resolve();return r.b(a,{params:_,request:i.DirectMessages.fetchInboxHistory})({actionTypes:h,context:"FETCH_DM_INBOX_HISTORY",meta:{timelineType:e}},(t=>{if(t){const{entries:n,users:r,tweets:a,cards:s,fleets:i}=t.entities,{inbox_timeline:o}=t.result;return ae({conversations:o.conversations,inbox_timelines:{[e]:o},entries:n,users:r,tweets:a,cards:s,fleets:i})}})).then((r=>{const s=r.result.inbox_timeline;if(n<3&&!s.conversations&&s.status===c.c.HAS_MORE)return a($(e,t,n+1))}))},Z=e=>(t,n)=>{const r=M(e,n(),"high");return t($(O,r))},ee=e=>(t,n)=>{const r=M(e,n(),"low");return t($(g,r))},te=e=>(t,n)=>{const r=M(e,n());return t($(v,r))},ne=Object(l.c)("UPDATE_INBOX"),re=e=>{const{inbox_timelines:t,...n}=e;return{payload:{cursors:t,lastSeenEventIds:n},type:ne}},ae=(e={})=>{const{conversations:t,entries:n,users:r,tweets:i,cards:o,fleets:c,cursor:d,...l}=e;var _;return[Object(a.c)({cards:o,tweets:i,users:r}),!Object(m.a)(t)&&Object(p.c)(t),!Object(m.a)(n)&&Object(s.a)(n),!Object(m.a)(d)&&Object(u.f)(d),!Object(m.a)(l)&&re(l),!Object(m.a)(c)&&(_=c,e=>{e({payload:{fleets:_},type:"rweb/fleets/ADD_DM_FLEETS"})})].filter((e=>e))},se=()=>e=>e(oe({withTrusted:!0})),ie=()=>e=>e(oe({withUntrusted:!0})),oe=({withTrusted:e,withUntrusted:t}={})=>(n,a,{api:s})=>{const i=a(),o=Object(p.C)(i),c=x(i),{last_seen_event_id:d,trusted_last_seen_event_id:u,untrusted_last_seen_event_id:l}=c,_=Object.values(o).reduce(((e,{data:{sort_event_id:t,trusted:n}})=>(e.last_seen_event_id=N(e.last_seen_event_id,t),e.trusted_last_seen_event_id=n?N(e.trusted_last_seen_event_id,t):e.trusted_last_seen_event_id,e.untrusted_last_seen_event_id=n?e.untrusted_last_seen_event_id:N(e.untrusted_last_seen_event_id,t),e)),{...c});if(Object(E.b)(_.last_seen_event_id,d)||e&&Object(E.b)(_.trusted_last_seen_event_id,u)||t&&Object(E.b)(_.untrusted_last_seen_event_id,l)){e||delete _.trusted_last_seen_event_id,t||delete _.untrusted_last_seen_event_id;return r.c(n,{params:_,request:s.DirectMessages.updateLastSeenEventId})({actionTypes:b,context:"APP_DM_UPDATE_LAST_SEEN",meta:{lastSeenEventIds:_}})}return Promise.resolve()},ce=Object(l.c)("POP_OUT_CONVERSATION"),de=e=>(t,n,{userPersistence:r})=>(r.set(I,{visibility:A.EXPANDED}),t({conversationId:e,type:ce})),ue=Object(l.c)("SET_DRAWER_VISIBILITY"),le=e=>({visibility:e,type:ue}),pe=e=>(t,n,{userPersistence:r})=>(r.set(I,{visibility:e}),e===A.CLOSED&&t({type:ce}),t(le(e))),_e=()=>(e,t,{userPersistence:n})=>n.get(I).then((t=>{t&&e(le(t.visibility))}))}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~loader.DMDrawer~bundle.Compose~bundle.RichTextCompose~bundle.DirectMessages~bundle.DMRichTextCompose~b.7ca1cc35.js.map